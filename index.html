<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Notes App</title>
  <!-- Link to normal CSS -->
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h2>Sticky Note App</h2>
  <div id="notes"></div>
<script>
    const notesContainer = document.getElementById("notes");

    // Set rows depending on screen size
    function rowsForViewport() {
      const w = window.innerWidth;
      if (w <= 480) return 1;      // mobile
      if (w <= 768) return 2;      // tablet
      return 3;                    // desktop
    }

    function applyRowsTo(textarea) {
      textarea.rows = rowsForViewport();
    }

    function applyRowsToAll() {
      document.querySelectorAll("#notes textarea").forEach(applyRowsTo);
    }

    window.addEventListener("resize", applyRowsToAll);

    // Create new note
    function createNote(content = "") {
      const noteDiv = document.createElement("div");
      noteDiv.className = "note-container";

      const textarea = document.createElement("textarea");
      textarea.value = content;
      applyRowsTo(textarea);

      const addBtn = document.createElement("button");
      addBtn.textContent = "+";
      addBtn.className = "add-btn";
      addBtn.onclick = () => {
        createNote();
        saveAllNotes();
      };

      const btnContainer = document.createElement("div");
      btnContainer.className = "buttons";

      const saveBtn = document.createElement("button");
      saveBtn.textContent = "Save";
      saveBtn.className = "save-btn";
      saveBtn.onclick = () => {
        if (textarea.value.trim() !== "") { 
          saveAllNotes();
          alert("Note saved!");
        } else {
          alert("Cannot save an empty note.");
        }
      };

      const editBtn = document.createElement("button");
      editBtn.textContent = "Disable";
      editBtn.className = "edit-btn";
      editBtn.onclick = () => {
        textarea.disabled = !textarea.disabled;
        editBtn.textContent = textarea.disabled ? "Enable" : "Disable";
      };

      const clearBtn = document.createElement("button");
      clearBtn.textContent = "Clear";
      clearBtn.className = "clear-btn";
      clearBtn.onclick = () => {
        textarea.value = "";
        saveAllNotes();
      };

      const deleteBtn = document.createElement("button");
      deleteBtn.textContent = "Delete";
      deleteBtn.className = "delete-btn";
      deleteBtn.onclick = () => {
        noteDiv.remove();
        saveAllNotes();
      };

      btnContainer.append(saveBtn, editBtn, clearBtn, deleteBtn);
      noteDiv.append(textarea, addBtn, btnContainer);
      notesContainer.appendChild(noteDiv);

      textarea.addEventListener("blur", saveAllNotes);
    }

    // Save all notes (skip empty)
    function saveAllNotes() {
      const textareas = document.querySelectorAll("#notes textarea");
      const notes = Array.from(textareas)
        .map(t => t.value.trim())
        .filter(val => val !== "");
      localStorage.setItem("notes", JSON.stringify(notes));
    }

    // Load notes from storage (with error handling)
    function loadNotes() {
      try {
        const saved = localStorage.getItem("notes");
        if (saved) {
          JSON.parse(saved).forEach(note => createNote(note));
        } else {
          createNote();
        }
      } catch (e) {
        console.error("Error loading notes:", e);
        localStorage.removeItem("notes");
        createNote();
      }
      applyRowsToAll();
    }

    loadNotes();
  </script>
</body>
</html>